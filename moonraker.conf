# ===================== Moonraker (cleaned) =====================

[server]
# Listen on all interfaces; leave port on 7125 (nginx handles :80)
host: 0.0.0.0
port: 7125
# Max upload size (MiB)
max_upload_size: 1024
# Klippy UDS path (default for KIAUH/MainsailOS)
klippy_uds_address: ~/printer_data/comms/klippy.sock

# Optional shell hooks (safe to leave empty)
[shell_command]

[file_manager]
# Prusa-style object cancel processing (False recommended on low SBCs)
enable_object_processing: False
# Allow uploads via UI
enable_object_upload: True
# Standard paths
config_path: ~/printer_data/config
gcode_path: ~/printer_data/gcodes
log_path: ~/printer_data/logs
backup_path: ~/printer_data/backup

[file_manager backup]
# Where Moonraker will write .zip backups (Mainsail Backup Now uses this)
path: ~/printer_data/backup

[authorization]
# Allow Mainsail cloud/local and common LAN hostnames
cors_domains:
    https://my.mainsail.xyz
    http://my.mainsail.xyz
    http://*.local
    http://*.lan
trusted_clients:
    10.0.0.0/8
    127.0.0.0/8
    169.254.0.0/16
    172.16.0.0/12
    192.168.0.0/16
    FE80::/10
    ::1/128

# Track and store print history
[history]

# Announcements feed for Mainsail
[announcements]
subscriptions:
    mainsail

# -------------------- Update Manager --------------------
[update_manager]
refresh_interval: 168
enable_auto_refresh: True

[update_manager mainsail]
type: web
channel: stable
repo: mainsail-crew/mainsail
path: ~/mainsail

[update_manager mainsail-config]
type: git_repo
primary_branch: master
path: ~/mainsail-config
origin: https://github.com/mainsail-crew/mainsail-config.git
managed_services: klipper

# Crowsnest (camera/stream)
[update_manager crowsnest]
type: git_repo
path: ~/crowsnest
origin: https://github.com/mainsail-crew/crowsnest.git
managed_services: crowsnest
install_script: tools/pkglist.sh

[gcode_shell_command backup_now]
command: bash /home/pi/backup_config.sh
timeout: 30
verbose: True

[button backup_button]
type: command
name: Backup Config
command: BACKUP_NOW

# -------------------- OctoPrint Compatibility --------------------
[octoprint_compat]

# ===================== end =====================

